"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express = require("express");
const http = require("http");
const next = require("next");
const sockIO = require("socket.io");
const app = express();
const httpServer = http.createServer(app);
const io = sockIO(httpServer);
const porta = process.env.PORT || 3000;
// const porta = process.env.PORT || 3000;
const dev = process.env.NODE_ENV !== "production";
const nextAPP = next({ dev, dir: "./dist" });
const nextHandler = nextAPP.getRequestHandler();
io.on("connect", (client) => {
    // tslint:disable-next-line:no-console
    console.log("CONECTOU PATRÃƒO");
    // tslint:disable-next-line:no-console
    client.on("enviaMSG", (msg) => io.emit("recebeMSG", msg));
    client.on("fezJogada", (jogada, vezJogador) => client.broadcast.emit("fezJogada", jogada, vezJogador));
    client.on("disconnect", () => {
        // tslint:disable-next-line:no-console
        console.log("DISCONECTOU");
    });
});
nextAPP.prepare().then(() => {
    app.get("/", (req, res) => {
        nextAPP.render(req, res, "/index");
    });
    app.get("/mensagens", (req, res) => {
        nextAPP.render(req, res, "/mensagens");
    });
    app.get("*", (req, res) => {
        return nextHandler(req, res);
    });
    httpServer.listen(porta, (err) => {
        if (err) {
            // tslint:disable-next-line:no-console
            console.log(err);
            return;
        }
        // tslint:disable-next-line:no-console
        console.log(`SERVIDOR INICIOU NA PORTA: ${porta}`);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VydmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc2VydmVyL3NlcnZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFtQztBQUNuQyw2QkFBNkI7QUFDN0IsNkJBQTZCO0FBQzdCLG9DQUFvQztBQUVwQyxNQUFNLEdBQUcsR0FBRyxPQUFPLEVBQUUsQ0FBQztBQUN0QixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzFDLE1BQU0sRUFBRSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUU5QixNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUM7QUFDdkMsMENBQTBDO0FBQzFDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxLQUFLLFlBQVksQ0FBQztBQUVsRCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7QUFDN0MsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLGlCQUFpQixFQUFFLENBQUM7QUFFaEQsRUFBRSxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRTtJQUMxQixzQ0FBc0M7SUFDdEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0lBRS9CLHNDQUFzQztJQUN0QyxNQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUUxRCxNQUFNLENBQUMsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUsRUFBRSxDQUM1QyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQyxDQUN2RCxDQUFDO0lBRUYsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO1FBQzNCLHNDQUFzQztRQUN0QyxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzdCLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUM7QUFFSCxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtJQUMxQixHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtRQUN4QixPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDckMsQ0FBQyxDQUFDLENBQUM7SUFFSCxHQUFHLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtRQUNqQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDekMsQ0FBQyxDQUFDLENBQUM7SUFFSCxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtRQUN4QixPQUFPLFdBQVcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDL0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFO1FBQy9CLElBQUksR0FBRyxFQUFFO1lBQ1Asc0NBQXNDO1lBQ3RDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDakIsT0FBTztTQUNSO1FBQ0Qsc0NBQXNDO1FBQ3RDLE9BQU8sQ0FBQyxHQUFHLENBQUMsOEJBQThCLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDckQsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcclxuaW1wb3J0ICogYXMgaHR0cCBmcm9tIFwiaHR0cFwiO1xyXG5pbXBvcnQgKiBhcyBuZXh0IGZyb20gXCJuZXh0XCI7XHJcbmltcG9ydCAqIGFzIHNvY2tJTyBmcm9tIFwic29ja2V0LmlvXCI7XHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcbmNvbnN0IGh0dHBTZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcihhcHApO1xyXG5jb25zdCBpbyA9IHNvY2tJTyhodHRwU2VydmVyKTtcclxuXHJcbmNvbnN0IHBvcnRhID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAwO1xyXG4vLyBjb25zdCBwb3J0YSA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDtcclxuY29uc3QgZGV2ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiO1xyXG5cclxuY29uc3QgbmV4dEFQUCA9IG5leHQoeyBkZXYsIGRpcjogXCIuL2Rpc3RcIiB9KTtcclxuY29uc3QgbmV4dEhhbmRsZXIgPSBuZXh0QVBQLmdldFJlcXVlc3RIYW5kbGVyKCk7XHJcblxyXG5pby5vbihcImNvbm5lY3RcIiwgKGNsaWVudCkgPT4ge1xyXG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1jb25zb2xlXHJcbiAgY29uc29sZS5sb2coXCJDT05FQ1RPVSBQQVRSw4NPXCIpO1xyXG5cclxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tY29uc29sZVxyXG4gIGNsaWVudC5vbihcImVudmlhTVNHXCIsIChtc2cpID0+IGlvLmVtaXQoXCJyZWNlYmVNU0dcIiwgbXNnKSk7XHJcblxyXG4gIGNsaWVudC5vbihcImZlekpvZ2FkYVwiLCAoam9nYWRhLCB2ZXpKb2dhZG9yKSA9PlxyXG4gICAgY2xpZW50LmJyb2FkY2FzdC5lbWl0KFwiZmV6Sm9nYWRhXCIsIGpvZ2FkYSwgdmV6Sm9nYWRvcilcclxuICApO1xyXG5cclxuICBjbGllbnQub24oXCJkaXNjb25uZWN0XCIsICgpID0+IHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1jb25zb2xlXHJcbiAgICBjb25zb2xlLmxvZyhcIkRJU0NPTkVDVE9VXCIpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbm5leHRBUFAucHJlcGFyZSgpLnRoZW4oKCkgPT4ge1xyXG4gIGFwcC5nZXQoXCIvXCIsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgbmV4dEFQUC5yZW5kZXIocmVxLCByZXMsIFwiL2luZGV4XCIpO1xyXG4gIH0pO1xyXG5cclxuICBhcHAuZ2V0KFwiL21lbnNhZ2Vuc1wiLCAocmVxLCByZXMpID0+IHtcclxuICAgIG5leHRBUFAucmVuZGVyKHJlcSwgcmVzLCBcIi9tZW5zYWdlbnNcIik7XHJcbiAgfSk7XHJcblxyXG4gIGFwcC5nZXQoXCIqXCIsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgcmV0dXJuIG5leHRIYW5kbGVyKHJlcSwgcmVzKTtcclxuICB9KTtcclxuXHJcbiAgaHR0cFNlcnZlci5saXN0ZW4ocG9ydGEsIChlcnIpID0+IHtcclxuICAgIGlmIChlcnIpIHtcclxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWNvbnNvbGVcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUubG9nKGBTRVJWSURPUiBJTklDSU9VIE5BIFBPUlRBOiAke3BvcnRhfWApO1xyXG4gIH0pO1xyXG59KTtcclxuIl19